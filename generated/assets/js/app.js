!function(){"use strict";async function e(e,t,n){const i=await async function(e,t,n){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Browser API navigator.mediaDevices.getUserMedia not available");const i=document.getElementById(e);i.width=t,i.height=n;const o=/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent),a=await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user",width:o?void 0:t,height:o?void 0:n}});return i.srcObject=a,new Promise(e=>{i.onloadedmetadata=()=>{e(i)}})}(e,t,n);return i.play(),i}function t(e,t,n,i,o,a){e.beginPath(),e.arc(n,t,i,0,2*Math.PI),e.fillStyle=o,e.fillText(a,n+5,t),e.fill()}const n=800,i=650;let o=!0,a=null;const d={architecture:"ResNet50",outputStride:32,inputResolution:257,quantBytes:2},s={architecture:"MobileNetV1",outputStride:16,inputResolution:513,multiplier:.75},l=document.getElementById("btn_radio_resnet"),r=document.getElementById("btn_radio_mobilenet");window.netModelSelected=function(e){o&&"resnet"==e.value?(a=d,l.disabled=!0,r.disabled=!0):o||"mobilenet"!=e.value||(a=s,l.disabled=!0,r.disabled=!0)},posenet.load(s).then(async function(d){let c;try{c=await e("video",n,i)}catch(e){throw document.getElementById("info").innerHTML="Could not load video",e}!function(e,d){const c=document.getElementById("output"),u=c.getContext("2d");c.width=n,c.height=i,async function c(){null!=a&&(d.dispose(),console.log("loading new config "+a),d=await posenet.load(a),o=a==s,a=null,l.disabled=!1,r.disabled=!1);const g=await d.estimatePoses(e,{flipHorizontal:!0,decodingMethod:"single-person"});u.clearRect(0,0,n,i);!function(e,t,n,i){e.save(),e.scale(-1,1),e.translate(-n,0),e.drawImage(t,0,0,n,i),e.restore()}(u,e,n,i);g.forEach(({score:e,keypoints:n})=>{e>=.3&&function(e,n,i,o=1){for(let a=0;a<e.length;a++){const d=e[a];if(d.score<n)continue;const{y:s,x:l}=d.position;t(i,s*o,l*o,3,"#ff2626",d.part+" "+d.score.toFixed(4))}}(n,.6,u)});requestAnimationFrame(c)}()}(c,d)})}();