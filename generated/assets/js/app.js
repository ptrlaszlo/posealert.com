!function(){"use strict";async function e(e,t,n){const o=await async function(e,t,n){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Browser API navigator.mediaDevices.getUserMedia not available");const o=document.getElementById(e);o.width=t,o.height=n;const i=await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}});return o.srcObject=i,new Promise(e=>{o.onloadedmetadata=()=>{e(o)}})}(e,t,n);return o.play(),o}function t(e,t,i){let a=i.videoWidth,d=i.videoHeight;e.clearRect(0,0,a,d),t.forEach(({score:t,keypoints:a})=>(function(e,t,i,a,d,s=!0){t>=a.minPoseConfidence&&function(e,t,i,a,d,s=1){for(let c=0;c<e.length;c++){const r=e[c];if(r.score<t.minPartConfidence)continue;const{y:l,x:u}=r.position,f="";d?n(i,l*s,u*s,t.distanceDelta,a):o(i,l*s,u*s,3,a,f)}}(i,a,e,d,s)})(e,t,a,i,"#ff2626",!1))}function n(e,t,n,o,i){e.beginPath(),e.arc(n,t,o,0,2*Math.PI),e.setLineDash([5,5]),e.strokeStyle=i,e.stroke()}function o(e,t,n,o,i,a){e.beginPath(),e.arc(n,t,o,0,2*Math.PI),e.fillStyle=i,e.fillText(a,n+5,t),e.fill()}const i=document.getElementById("debugcanvas");i.getContext("2d");i.width=200,i.height=200;const a=document.getElementById("msgbox"),d=document.getElementById("msg");function s(e){d.innerHTML=e,a.classList.remove("no-display")}function c(e,t,n,o,i){let a=r(n,t,o),d=r(n,e,o);return void 0!==a&&void 0!==d&&(!(Math.abs(a.position.x-d.position.x)>=i)&&!(Math.abs(a.position.y-d.position.y)>=i))}function r(e,t,n){return e.keypoints.find(({part:e,score:o})=>e===t&&o>=n)}const l="nose",u="leftEye",f="rightEye",g="leftWrist",y="rightWrist";let h={debugMode:!1,saveNextPose:!1,playSound:!0,correctPose:void 0,detectionDelayMs:1e3,historySize:10,distanceDelta:170,minPoseConfidence:.3,minPartConfidence:.6,videoWidth:800,videoHeight:650};const m={architecture:"MobileNetV1",outputStride:16,inputResolution:513,multiplier:.75};window.config=h;const p=new Audio("assets/beep-07.mp3");function v(){let e=document.getElementById("mute");h.playSound?(h.playSound=!1,e.innerHTML="ðŸ”‡"):(h.playSound=!0,e.innerHTML="ðŸ”‰")}!async function(){let n,o;try{n=await e("video",h.videoWidth,h.videoHeight)}catch(e){throw s("Couldn't load video, please try a different browser"),e}try{o=await posenet.load(m)}catch(e){throw s("Couldn't load posenet, please try refreshing the page"),e}!function(e,n){const o=document.getElementById("output"),i=o.getContext("2d");o.width=h.videoWidth,o.height=h.videoHeight,async function o(){const d=await n.estimatePoses(e,{flipHorizontal:!0,decodingMethod:"single-person"}),s=d[0];s.score>=h.minPoseConfidence&&function(e,t,n){return c(g,l,e,t,n)||c(y,l,e,t,n)||c(g,u,e,t,n)||c(y,u,e,t,n)||c(g,f,e,t,n)||c(y,f,e,t,n)}(s,h.minPartConfidence,h.distanceDelta)&&h.playSound&&(a.classList.add("no-display"),p.play()),setTimeout((function(){requestAnimationFrame(o)}),h.detectionDelayMs),h.debugMode&&t(i,d,h)}()}(n,o)}(),document.getElementById("mute").onclick=function(){v()},document.onkeypress=function(e){77!=(e=e||window.event).keyCode&&109!=e.keyCode||v()}}();