!function(){"use strict";async function e(e,t,n){const i=await async function(e,t,n){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Browser API navigator.mediaDevices.getUserMedia not available");const i=document.getElementById(e);i.width=t,i.height=n;const o=/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent),a=await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user",width:o?void 0:t,height:o?void 0:n}});return i.srcObject=a,new Promise(e=>{i.onloadedmetadata=()=>{e(i)}})}(e,t,n);return i.play(),i}function t(e,t,n,i,o,a){e.beginPath(),e.arc(n,t,i,0,2*Math.PI),e.fillStyle=o,e.fillText(a,n+5,t),e.fill()}const n=800,i=650;let o=!0,a=null;const s={architecture:"ResNet50",outputStride:32,inputResolution:257,quantBytes:2},c={architecture:"MobileNetV1",outputStride:16,inputResolution:513,multiplier:.75};window.netModelSelected=function(e){o&&"resnet"==e.value?a=s:o||"mobilenet"!=e.value||(a=c)},posenet.load(c).then(async function(s){let r;try{r=await e("video",n,i)}catch(e){throw document.getElementById("info").innerHTML="Could not load video",e}!function(e,s){const r=document.getElementById("output"),d=r.getContext("2d");r.width=n,r.height=i,async function r(){null!=a&&(s.dispose(),console.log("loading new config "+a),s=await posenet.load(a),o=a==c,a=null);const l=await s.estimatePoses(e,{flipHorizontal:!0,decodingMethod:"single-person"});d.clearRect(0,0,n,i);!function(e,t,n,i){e.save(),e.scale(-1,1),e.translate(-n,0),e.drawImage(t,0,0,n,i),e.restore()}(d,e,n,i);l.forEach(({score:e,keypoints:n})=>{e>=.3&&function(e,n,i,o=1){for(let a=0;a<e.length;a++){const s=e[a];if(s.score<n)continue;const{y:c,x:r}=s.position;t(i,c*o,r*o,3,"#ff2626",s.part+" "+s.score.toFixed(4))}}(n,.6,d)});requestAnimationFrame(r)}()}(r,s)})}();