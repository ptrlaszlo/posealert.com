!function(){"use strict";async function e(e,t,n){const i=await async function(e,t,n){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Browser API navigator.mediaDevices.getUserMedia not available");const i=document.getElementById(e);i.width=t,i.height=n;const o=await navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}});return i.srcObject=o,new Promise(e=>{i.onloadedmetadata=()=>{e(i)}})}(e,t,n);return i.play(),i}function t(e,t,n,i,o,a){e.beginPath(),e.arc(n,t,i,0,2*Math.PI),e.fillStyle=o,e.fillText(a,n+5,t),e.fill()}const n=800,i=650;let o=!0,a=null;const d={architecture:"ResNet50",outputStride:32,inputResolution:257,quantBytes:2},s={architecture:"MobileNetV1",outputStride:16,inputResolution:513,multiplier:.75},c=document.getElementById("btn_radio_resnet"),l=document.getElementById("btn_radio_mobilenet");window.netModelSelected=function(e){o&&"resnet"==e.value?(a=d,c.disabled=!0,l.disabled=!0):o||"mobilenet"!=e.value||(a=s,c.disabled=!0,l.disabled=!0)},posenet.load(s).then(async function(d){let r;try{r=await e("video",n,i)}catch(e){throw document.getElementById("info").innerHTML="Could not load video",e}!function(e,d){const r=document.getElementById("output"),u=r.getContext("2d");r.width=n,r.height=i,async function r(){null!=a&&(d.dispose(),console.log("loading new config "+a),d=await posenet.load(a),o=a==s,a=null,c.disabled=!1,l.disabled=!1);const f=await d.estimatePoses(e,{flipHorizontal:!0,decodingMethod:"single-person"});u.clearRect(0,0,n,i);f.forEach(({score:e,keypoints:n})=>{e>=.3&&function(e,n,i,o=1){for(let a=0;a<e.length;a++){const d=e[a];if(d.score<n)continue;const{y:s,x:c}=d.position;t(i,s*o,c*o,3,"#ff2626",d.part+" "+d.score.toFixed(4))}}(n,.6,u)});setTimeout(function(){requestAnimationFrame(r)},2e3)}()}(r,d)})}();